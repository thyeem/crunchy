<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scaleable=yes">
    <meta property="og:title" content="Crunchy: Never played crispy Omok like this.">
    <meta property="og:description" content="A variation of Omok or Gomoku by adding an interesting rule.">
    <meta property="og:image" content="media/og-image.png">
    <link rel="stylesheet" href="[% css_fa %]">
    <link rel="stylesheet" href="[% css_bcf %]">
    <script src="[% js_jquery %]"></script>
    <script src="[% js_bcf %]"></script>
    <script src="[% js_hasher %]"></script>
    <title>[% title %]</title>
    <link href="https://fonts.googleapis.com/css?family=Alegreya:regular,bold,italic,bolditalic" rel="stylesheet">
    <!--link rel="icon" type="image/png" sizes="96x96" href="img/favicon.png"-->
</head>

<body>
<div id="wrapper">
    <div id="header">
    <!-- title & game id -->
    <form id="form" action="index.pl" method="[% method %]">
        <div class="l-block">
            <!-- Crunchy mode -->
            <div class="menu" title="Toggle Crunchy mode">
                <a href="#" id="bcf-mode">
                <i class="fa fa-toggle-on" id="bcf-switch"
                   style="color:#299c39;font-size:46px"></i>
                </a> [% L %]
            </div>

            <!-- new game -->
            <div class="menu" title="New game">
                <a href="./" id="new-game">
                <i class="fa fa-delicious" style="color:#3152a5"></i>
                </a> [% L %][% M %]
            </div>

            <!-- replay -->
            <div class="menu" title="Replay the saved games">
                <a href="#" id="replay">
                <i class="fa fa-bookmark" style="color:#ff3118"></i>
                </a> [% L %]
                <div id="rp-list" class="float-div float-box">
                [% FOREACH db IN gamelist %]
                    <div>
                        <a href="#" id="[% db.id %]" class="rp-del">[x]</a>[% L %]
                        <a href="index.pl?id=[% db.id %]&do=replay&bcf=1">[% db.msg %]</a>
                    </div>
                [% END %]
                </div>
            </div>

            <!-- save -->
            <div class="menu">
                <a href="#" id="save" title="Save the current game">
                <i class="fa fa-rss" style="color:#31b5d6;"></i>
                </a> [% L %]
                <div id="msg-div" class="float-div">
                    <input type="text" id="msg" name="msg" class="float-box"
                     placeholder="Save the game: give a description.">
                </div>
                <div id="key-div" class="float-div">
                    <input type="password" id="pwd" name="pwd" class="float-box"
                     placeholder="Secret key">
                </div>
            </div>

            <!-- undo -->
            <div class="menu" title="Undo last move">
                <a href="#" id="undo">
                <i class="fa fa-undo" style="color:#ff6342;font-size:44px"></i>
                </a>
                [% L %]
            </div>

            <!-- game lock -->
            <div class="menu" title="Game status: locked/unlocked">
                <i class="fa fa-unlock" id="game-status-lock"
                   style="color:#555;font-size:44px"></i>
                [% L %]
            </div>
        </div>

        <div class="l-block">
            <!-- players / victory Points -->
            <div class="menu_id_score">
                <label>
                    <input type="radio" name="pB" value="human" checked>
                    <img class="player-avatar" src="img/id_human.png" title="Set Human as black player">
                <label>
                <label>
                    <input type="radio" name="pB" value="sofia">
                    <img class="player-avatar" src="img/id_sofia.png" title="Set SofiAI as black player">
                <label>
                <label>
                    <input type="radio" name="pB" value="maria">
                    <img class="player-avatar" src="img/id_maria.png" title="Set MariAI as black player">
                <label>

                [% M %]<span style="color:#d3d4e8">|</span>[% M %]
                <img class="stones" src="img/30px/black.png" title="Black victory points">
                [% S %][% board.scoreB %]
                [% S %]
                <img class="stones" src="img/30px/white.png" title="White victory points">
                [% S %][% board.scoreW %]
                [% M %]<span style="color:#d3d4e8">|</span>[% M %]

                <label>
                    <input type="radio" name="pW" value="human" checked>
                    <img class="player-avatar" src="img/id_human.png" title="Set Human as white player">
                <label>
                <label>
                    <input type="radio" name="pW" value="sofia">
                    <img class="player-avatar" src="img/id_sofia.png" title="Set SofiAI as white player">
                <label>
                <label>
                    <input type="radio" name="pW" value="maria">
                    <img class="player-avatar" src="img/id_maria.png" title="Set MariAI as white player">
                <label>

            </div>
        </div>


        <!-- hidden values -->
        <input type="hidden" id="id" name="id" value="[% id %]">
        <input type="hidden" id="bcf" name="bcf" value="[% bcf %]">
        <input type="hidden" id="turn" name="turn" value="[% board.turn %]">
        <input type="hidden" id="moves" name="moves" value="[% board.moves %]">
        <input type="hidden" id="x" name="x" value="[% board.X %]">
        <input type="hidden" id="y" name="y" value="[% board.Y %]">
        <input type="hidden" id="eB" name="eB" value="[% eB %]">
        <input type="hidden" id="eW" name="eW" value="[% eW %]">
        <input type="hidden" id="do" name="do">
        <input type="hidden" id="go" name="go">
        <input type="hidden" id="SOFIAI" value="[% SOFIAI %]">
        <input type="hidden" id="MARIAI" value="[% MARIAI %]">
        <input type="hidden" id="HUMAN" value="[% HUMAN %]">
        <input type="hidden" id="BLACK" value="[% BLACK %]">
        <input type="hidden" id="WHITE" value="[% WHITE %]">
        <input type="hidden" id="EMPTY" value="[% EMPTY %]">
        <input type="hidden" id="UNIT" value="[% UNIT %]">
        <input type="hidden" id="NL" value="[% NL %]">
        <input type="hidden" id="locked" value="[% locked %]">
        <input type="hidden" id="view" value="[% view %]">
        <input type="hidden" id="alert" value="[% alert %]">
        <input type="hidden" id="pBset" value="[% pB %]">
        <input type="hidden" id="pWset" value="[% pW %]">
        <input type="hidden" id="did" name="did">
    </form></div>


    <!-- winning probability -->
    <div id="prob">
        <span class="overflow inline-block-fixed" id="black-wp"></span><span class="overflow inline-block-fixed" id="white-wp"></span>
    </div>

    <!-- loading spinner -->
    <div id="spinner"></div>

    <!-- game board -->
    <div><canvas id="board" width="570" height="570"></canvas></div>

    <!-- about the game: crunchy -->
    <center>
    <div id="help">
    <h2>* What's this game?</h2>
    <h4><u>Crunchy</u> [% dash %] A brand new game created by Francis.<br/>
    He wanted to make <a href="https://en.wikipedia.org/wiki/Gomoku"><u>Omok (a.k.a. Gomoku)</u></a>
    more interesting by adding a very simple rule [% dash %] <u>Crunchy rule</u>.</h4>

    <hr>
    <h2>* Rule</h2>
    <h4><u>Crunchy rule</u> [% dash %] One can clamp the enemy's two successive stones
    in any directions if any. Feel free to capture those stones.<br/><br/>
    (1) <u>Firstly making five stones in a row</u> [% dash %]> <i>victory</i><br/>
    (2) <u>Firstly getting 10(ten) captured stones</u> [% dash %]> <i>victory</i></h4>

    <hr>
    <h2>* Playing with AIs [% L %]
    <img class="avatar" src="img/id_sofia.png">[% M %]<img class="avatar" src="img/id_maria.png"></h2>
    <h4>Francis created some AI applications for this game [% dash %]
    <u>SofiAI</u> and <u>MariAI</u> [% dash %] Just select one from AI avatars to play with.<br/>
    Enjoy the time with them.</h4>

    <hr>
    <h2>* Menu</h2>
    <h4><i class="fa fa-toggle-on" style="color:#299c39;font-size:30px;vertical-align:middle;"></i>
    [% L %] Toggle Crunchy game mode.</h4>
    <h4><i class="fa fa-delicious" style="color:#3152a5;font-size:30px;vertical-align:middle;"></i>
    [% L %] Start a new game</h4>
    <h4><i class="fa fa-bookmark" style="color:#ff3118;font-size:30px;vertical-align:middle;"></i>
    [% L %] Load the saved game list to replay</h4>
    <h4><i class="fa fa-rss" style="color:#31b5d6;font-size:30px;vertical-align:middle;"></i>
    [% L %] Save the game that is playing now</h4>
    <h4><i class="fa fa-undo" style="color:#ff6342;font-size:30px;vertical-align:middle;"></i>
    [% L %] Undo last move played</h4>
    <h4><i class="fa fa-lock" style="color:#555;font-size:30px;vertical-align:middle;"></i>
    [% L %] When locked you cannot play, you can replay only.</h4>
    <h4><img src="img/spinner.svg" style="height:24px;vertical-align:middle;">
    [% L %] Indicating AI is thinking</h4>

    <hr>
    <h2>* Estimated Winning Probability (EWP)</h2>
    <div style="border: solid 1px #444;background-color:#eee;width:400px;">
    <div style="text-align:center;color:#eee;height:20px;
                width:70%;background-color:#444">70%</div></div>
    <h4>
    <u>EWP</u> is basically about the odds of <u>MARIAI's winning over the opposing player</u>.
    MariAI evaluates her winning probability based on the result of almost 1+ million Monte-Carlo Tree Search (MTCS).</br></br>
    Thus, EWP is <u>only updated right after every MariAI's move</u>.
    The number of Monte Carlo simulations depends on the game parameter, and is closely related to her ponding time.</br>

    <hr>
    <h2>* Shortcuts</h2>
    <h4>
    Ctrl + n [% dash %] Start a new game<br/>
    Ctrl + u [% dash %] Undo last move played<br/>
    Ctrl + t [% dash %] Toggle the Crunchy mode<br/>
    Ctrl + l [% dash %] Show the saved game list<br/>
    Ctrl + s [% dash %] Save the game now playing<br/>
    0 [% dash %] Go to the first move<br/>
    9 [% dash %] Go to the last move<br/>
    [right-arrow] [% dash %] Go to the next move<br/>
    [left-arrow] [% dash %] Go to the previous move<br/>
    [up-arrow] [% dash %] Jump to the previous 5- move<br/>
    [down-arrow] [% dash %] Jump to the next 5+ move<br/>
    </div></center>

    <!-- copyright -->
    <center>Crunchy [% dash %] (c) 2017-2021 Francis.</center>
</div>


<!-- popup msg -->
[% IF alert %]
<script>setTimeout(function() { alert("[% alert %]") }, 300);</script>
[% END %]

</body>
</html>
